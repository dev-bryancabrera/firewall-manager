<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    {% include 'includes/styles-imports.html' %}
    <!-- Multiselect -->
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.14.0-beta2/css/bootstrap-select.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/rules.css') }}" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.15.4/dist/bootstrap-table.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <title>Firewall Configuracion</title>
</head>

<body>

    {% extends 'navbar.html' %}

    {% block content %}
    <!-- Estructura -->
    <section class="container-form">
        <div class="title-form">
            <h1 class="title">Firewall Manager</h1>
        </div>
        <div class="button-create">
            <button type="button" class="btn btn-success" id="btncreate" data-bs-toggle="modal"
                data-bs-target="#modalReglas">
                Crear Nueva Regla
            </button>
        </div>
        <div class="tables-content">

            <div class="firewall-rules in-rules">
                <!-- Mostras las reglas del ufw -->
                <div class="subtitle-tables">
                    <h2>Reglas Firewall de Entrada</h2>
                </div>
                {% if 'error' in reglas_in[0] %}
                <p>{{ reglas_in[0]['error'] }}</p>
                {% else %}
                <table id="tableFirewallIn" class="table">
                    <tr>
                        <th data-field="number" data-sortable="true">N° REGLA</th>
                        <th data-field="name" data-sortable="true" style="min-width: 180px;">NOMBRE DE REGLA</th>
                        <th data-field="created_date" data-sortable="true">FECHA DE CREACION</th>
                        <th data-field="ip" data-sortable="true">ORIGEN</th>
                        <th data-field="action" data-sortable="true" style="min-width: 150px;">ACCION DE FIREWALL</th>
                        <th data-field="protocol" data-sortable="true">PROTOCOLO</th>
                        <th data-field="entry" data-sortable="true" style="min-width: 150px;">DIRECCION DE REGLA</th>
                        <th data-field="direction" data-sortable="true">DESTINO</th>
                    </tr>
                    {% for regla in reglas_in %}
                    <tr>
                        <!-- <td>{{ regla['numero'] }}</td> -->
                        <td class="numero">{{ regla['contador'] }}</td>
                        <td class="nombre">{{ regla['nombre'] }}</td>
                        <td class="fecha_creacion">{{ regla['fecha_creacion'] }}</td>
                        <td class="ip">{{ regla['ip'] }}</td>
                        <td class="accion">{{ regla['accion'] }}</td>
                        <td class="protocolo">{{ regla['protocolo'] }}</td>
                        <td class="entrada">{{ regla['entrada'] }}</td>
                        <td class="direccion">{{ regla['direccion'] }}</td>
                        <td>
                            {% if regla['estado'] == 1 %}
                            <a href="{{ url_for('desactivar_regla', contador=regla['contador'], numero=regla['numero'], nombre=regla['nombre'], fechaCreacion=regla['fecha_creacion'], ip=regla['ip'], accion=regla['accion'], protocolo=regla['protocolo'], entrada=regla['entrada'], direccion=regla['direccion']) }}"
                                class="btn btn-success">Desactivar</a>
                            {% elif regla['estado'] == 0 %}
                            <a href="{{ url_for('desactivar_regla', contador=regla['contador'], numero=regla['numero'], nombre=regla['nombre'], fechaCreacion=regla['fecha_creacion'], ip=regla['ip'], accion=regla['accion'], protocolo=regla['protocolo'], entrada=regla['entrada'], direccion=regla['direccion']) }}"
                                class="btn btn-secondary">Activar</a>
                            {% endif %}
                        </td>
                        <td>
                            <button type="button" class="btn btn-danger" data-bs-toggle="modal"
                                data-bs-target="#confirmarEliminar{{ regla['numero'] }}">
                                Eliminar Regla
                            </button>

                            <!-- Modal Eliminar Regla -->
                            <div class="modal fade" id="confirmarEliminar{{ regla['numero'] }}" tabindex="-1"
                                aria-labelledby="confirmacionModalLabel" aria-hidden="true">
                                <input type="hidden" name="rule_name" value="{{ regla['nombre'] }}">
                                <input type="hidden" name="rule_number" value="{{ regla['numero'] }}">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="confirmacionModalLabel">
                                                Confirmar Eliminación
                                            </h5>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                aria-label="Cerrar"></button>
                                        </div>
                                        <div class="modal-body">
                                            ¿Estás seguro de que deseas eliminar la regla?
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                                Cancelar
                                            </button>
                                            <a href="{{ url_for('eliminar_regla', regla=regla['numero'], nombre=regla['nombre']) }}"
                                                class="btn btn-danger">Eliminar</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td>
                            <button type="button" class="btn btn-primary editarReglaBtn" data-bs-toggle="modal"
                                data-bs-target="#editarRegla{{ regla['numero'] }}">
                                Visualizar Regla
                            </button>

                            <!-- Modal Editar Regla -->
                            <div class="modal fade" id="editarRegla{{ regla['numero'] }}" tabindex="-1"
                                aria-labelledby="editarReglaLabel" aria-hidden="true">
                                <div class="modal-dialog modal-dialog-centered">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="editarReglaLabel">Visualizar Regla</h5>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                aria-label="Cerrar"></button>
                                        </div>
                                        <div class="modal-body">
                                            <div class="container-ssh">
                                                <div class="subtitle">
                                                    <h2>Regla</h2>
                                                </div>
                                                <div class="form-wrap">
                                                    <form action="/edit_rule" method="post" class="form-content"
                                                        id="editFormFirewall">

                                                        <div class="rule-name">
                                                            <div class="form-group">
                                                                <label id="editComment" class="form-control"
                                                                    name="comment" disabled>{{ regla['nombre']
                                                                    }}</label>
                                                            </div>
                                                        </div>

                                                        <input type="hidden" name="rule_number"
                                                            value="{{ regla['numero'] }}">

                                                        <div class="form-inputs">

                                                            <div class="form1">

                                                                <div class="form-group">
                                                                    <label for="editSelectEntry">Entrada o
                                                                        Salida</label>
                                                                    <select class="form-select" name="entry"
                                                                        id="editEntry">
                                                                        <option value="" selected disabled>
                                                                            Seleccionar...
                                                                        </option>
                                                                        <option value="in">Entrada</option>
                                                                        <option value="out">Salida</option>
                                                                    </select>
                                                                </div>

                                                                <div class="form-group">
                                                                    <label for="fromto">Dirección de la Regla</label>
                                                                    <input type="text" class="form-control"
                                                                        name="fromto" id="editFromTo"
                                                                        placeholder="0.0.0.0">
                                                                </div>

                                                                <div class="form-group">
                                                                    <label for="ipaddr">Direccion IP</label>
                                                                    <input type="text" class="form-control"
                                                                        name="ip_addr" id="editaripaddr"
                                                                        placeholder="0.0.0.0">
                                                                </div>

                                                                <!-- <div class="form-group">
                                                                <label for="netmask">Mascara de Red</label>
                                                                <input type="text" class="form-control" name="netmask"
                                                                    id="editNetmask">
                                                            </div> -->

                                                                <!-- <div class="form-group">
                                                                <label for="ipdest">Direccion IP de Destino</label>
                                                                <input type="text" class="form-control" name="ip_dest"
                                                                    id="editaripdest" placeholder="0.0.0.0">
                                                            </div> -->

                                                                <!-- <div class="form-group">
                                                                <label for="ipdest">Mascara de Red Destino</label>
                                                                <input type="text" class="form-control"
                                                                    name="dest_netmask" id="editMaskdest">
                                                            </div> -->

                                                                <div class="form-group">
                                                                    <label for="inputPort">Puerto</label>
                                                                    <input type="text" class="form-control" name="port"
                                                                        id="editport">
                                                                </div>
                                                            </div>

                                                            <div class="form2">
                                                                <div class="form-group">
                                                                    <label for="rangePorts" id="puertos">Establecer
                                                                        Rango de
                                                                        Puertos</label>
                                                                    <select class="form-select" name="rangePorts"
                                                                        id="editPortRange">
                                                                        <option value="" selected disabled>
                                                                            Seleccionar...
                                                                        </option>
                                                                        <option value="yes">Si</option>
                                                                        <option value="no">No</option>
                                                                    </select>
                                                                </div>

                                                                <div class="form-group">
                                                                    <label for="inputPort" id="puertoEntrada">Puerto
                                                                        Inicial</label>
                                                                    <input type="text" class="form-control"
                                                                        name="portStart" id="editportStart">
                                                                </div>

                                                                <div class="form-group">
                                                                    <label for="inputPort" id="puertoSalida">Puerto
                                                                        Final</label>
                                                                    <input type="text" class="form-control"
                                                                        name="portLimit" id="editportLimit">
                                                                </div>

                                                                <div class="form-group">
                                                                    <label for="selectProtocol">Protocolo</label>
                                                                    <select class="form-select" name="protocol"
                                                                        id="editProtocol">
                                                                        <option value="" selected disabled>
                                                                            Seleccionar...
                                                                        </option>
                                                                        <option value="tcp">TCP</option>
                                                                        <option value="udp">UDP</option>
                                                                        <option value="">TCP/UDP</option>
                                                                    </select>
                                                                </div>
                                                            </div>

                                                        </div>

                                                        <label for="response">{{response}}</label>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary"
                                                data-bs-dismiss="modal">Cerrar</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </table>
                {% endif %}
            </div>

            <div class="firewall-rules out-rules">
                <!-- Mostras las reglas del ufw -->
                <div class="subtitle-tables">
                    <h2>Reglas Firewall de Salida</h2>
                </div>
                {% if 'error' in reglas_out[0] %}
                <p>{{ reglas_out[0]['error'] }}</p>
                {% else %}
                <table id="tableFirewallOut" class="table">
                    <tr>
                        <th data-field="number" data-sortable="true">N° REGLA</th>
                        <th data-field="name" data-sortable="true" style="min-width: 180px;">NOMBRE DE REGLA</th>
                        <th data-field="created_date" data-sortable="true">FECHA DE CREACION</th>
                        <th data-field="ip" data-sortable="true">ORIGEN</th>
                        <th data-field="action" data-sortable="true" style="min-width: 150px;">ACCION DE FIREWALL</th>
                        <th data-field="protocol" data-sortable="true">PROTOCOLO</th>
                        <th data-field="entry" data-sortable="true" style="min-width: 150px;">DIRECCION DE REGLA</th>
                        <th data-field="direction" data-sortable="true">DESTINO</th>
                    </tr>
                    {% for regla in reglas_out %}
                    <tr>
                        <!-- <td>{{ regla['numero'] }}</td> -->
                        <td class="number">{{ regla['contador'] }}</td>
                        <td class="name">{{ regla['nombre'] }}</td>
                        <td class="created_date">{{ regla['fecha_creacion'] }}</td>
                        <td class="ip">{{ regla['ip'] }}</td>
                        <td class="action">{{ regla['accion'] }}</td>
                        <td class="protocol">{{ regla['protocolo'] }}</td>
                        <td class="entry">{{ regla['entrada'] }}</td>
                        <td class="direction">{{ regla['direccion'] }}</td>
                        <td>
                            {% if regla['estado'] == 1 %}
                            <a href="{{ url_for('desactivar_regla', contador=regla['contador'], numero=regla['numero'], nombre=regla['nombre'], fechaCreacion=regla['fecha_creacion'], ip=regla['ip'], accion=regla['accion'], protocolo=regla['protocolo'], entrada=regla['entrada'], direccion=regla['direccion']) }}"
                                class="btn btn-success">Desactivar</a>
                            {% elif regla['estado'] == 0 %}
                            <a href="{{ url_for('desactivar_regla', contador=regla['contador'], numero=regla['numero'], nombre=regla['nombre'], fechaCreacion=regla['fecha_creacion'], ip=regla['ip'], accion=regla['accion'], protocolo=regla['protocolo'], entrada=regla['entrada'], direccion=regla['direccion']) }}"
                                class="btn btn-secondary">Activar</a>
                            {% endif %}
                        </td>
                        <td>
                            <button type="button" class="btn btn-danger" data-bs-toggle="modal"
                                data-bs-target="#confirmarEliminar{{ regla['numero'] }}">
                                Eliminar Regla
                            </button>

                            <!-- Modal Eliminar Regla -->
                            <div class="modal fade" id="confirmarEliminar{{ regla['numero'] }}" tabindex="-1"
                                aria-labelledby="confirmacionModalLabel" aria-hidden="true">
                                <input type="hidden" name="rule_number" value="{{ regla['numero'] }}">
                                <input type="hidden" name="rule_name" value="{{ regla['nombre'] }}">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="confirmacionModalLabel">
                                                Confirmar Eliminación
                                            </h5>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                aria-label="Cerrar"></button>
                                        </div>
                                        <div class="modal-body">
                                            ¿Estás seguro de que deseas eliminar la regla?
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                                Cancelar
                                            </button>
                                            <a href="{{ url_for('eliminar_regla', regla=regla['numero'], nombre=regla['nombre']) }}"
                                                class="btn btn-danger">Eliminar</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td>
                            <button type="button" class="btn btn-primary editarReglaBtn" data-bs-toggle="modal"
                                data-bs-target="#editarRegla{{ regla['numero'] }}">
                                Visualizar Regla
                            </button>

                            <!-- Modal Editar Regla -->
                            <div class="modal fade" id="editarRegla{{ regla['numero'] }}" tabindex="-1"
                                aria-labelledby="editarReglaLabel" aria-hidden="true">
                                <div class="modal-dialog modal-dialog-centered">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="editarReglaLabel">Visualizar Regla</h5>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                aria-label="Cerrar"></button>
                                        </div>
                                        <div class="modal-body">
                                            <div class="container-ssh">
                                                <div class="subtitle">
                                                    <h2>Regla</h2>
                                                </div>
                                                <div class="form-wrap">
                                                    <form action="/edit_rule" method="post" class="form-content"
                                                        id="editFormFirewall">

                                                        <div class="rule-name">
                                                            <div class="form-group">
                                                                <label id="editComment" class="form-control"
                                                                    name="comment" disabled>{{ regla['nombre']
                                                                    }}</label>
                                                            </div>
                                                        </div>

                                                        <input type="hidden" name="rule_number"
                                                            value="{{ regla['numero'] }}">

                                                        <div class="form-inputs">

                                                            <div class="form1">

                                                                <div class="form-group">
                                                                    <label for="editSelectEntry">Entrada o
                                                                        Salida</label>
                                                                    <select class="form-select" name="entry"
                                                                        id="editEntry">
                                                                        <option value="" selected>Seleccionar...
                                                                        </option>
                                                                        <option value="in">Entrada</option>
                                                                        <option value="out">Salida</option>
                                                                    </select>
                                                                </div>

                                                                <div class="form-group">
                                                                    <label for="fromto">Dirección de la Regla</label>
                                                                    <input type="text" class="form-control"
                                                                        name="fromto" id="editFromTo"
                                                                        placeholder="0.0.0.0">
                                                                </div>

                                                                <div class="form-group">
                                                                    <label for="ipaddr">Direccion IP</label>
                                                                    <input type="text" class="form-control"
                                                                        name="ip_addr" id="editaripaddr"
                                                                        placeholder="0.0.0.0">
                                                                </div>

                                                                <!-- <div class="form-group">
                                                                <label for="netmask">Mascara de Red</label>
                                                                <input type="text" class="form-control" name="netmask"
                                                                    id="editNetmask">
                                                            </div> -->

                                                                <!-- <div class="form-group">
                                                                <label for="ipdest">Direccion IP de Destino</label>
                                                                <input type="text" class="form-control" name="ip_dest"
                                                                    id="editaripdest" placeholder="0.0.0.0">
                                                            </div> -->

                                                                <!-- <div class="form-group">
                                                                <label for="ipdest">Mascara de Red Destino</label>
                                                                <input type="text" class="form-control"
                                                                    name="dest_netmask" id="editMaskdest">
                                                            </div> -->

                                                                <div class="form-group">
                                                                    <label for="inputPort">Puerto</label>
                                                                    <input type="text" class="form-control" name="port"
                                                                        id="editport">
                                                                </div>
                                                            </div>

                                                            <div class="form2">
                                                                <div class="form-group">
                                                                    <label for="rangePorts" id="puertos">Rango de
                                                                        Puertos</label>
                                                                    <select class="form-select" name="rangePorts"
                                                                        id="editPortRange">
                                                                        <option value="" selected disabled>
                                                                            Seleccionar...
                                                                        </option>
                                                                        <option value="yes">Si</option>
                                                                        <option value="no">No</option>
                                                                    </select>
                                                                </div>

                                                                <div class="form-group">
                                                                    <label for="inputPort" id="puertoEntrada">Puerto
                                                                        Inicial</label>
                                                                    <input type="text" class="form-control"
                                                                        name="portStart" id="editportStart">
                                                                </div>

                                                                <div class="form-group">
                                                                    <label for="inputPort" id="puertoSalida">Puerto
                                                                        Final</label>
                                                                    <input type="text" class="form-control"
                                                                        name="portLimit" id="editportLimit">
                                                                </div>

                                                                <div class="form-group">
                                                                    <label for="selectProtocol">Protocolo</label>
                                                                    <select class="form-select" name="protocol"
                                                                        id="editProtocol" required>
                                                                        <option value="select" selected disabled>
                                                                            Seleccionar...
                                                                        </option>
                                                                        <option value="tcp">TCP</option>
                                                                        <option value="udp">UDP</option>
                                                                        <option value="">TCP/UDP</option>
                                                                    </select>
                                                                </div>
                                                            </div>

                                                        </div>

                                                        <label for="response">{{response}}</label>
                                                    </form>
                                                </div>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary"
                                                    data-bs-dismiss="modal">Cerrar</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </table>
                {% endif %}
            </div>
        </div>

        <!-- Modal Crear Regla -->
        <div class="modal fade" id="modalReglas" tabindex="-1" aria-labelledby="modalReglasLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="modalReglasLabel">Crear Nueva Regla</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="container-ssh">
                            <div class="subtitle">
                                <h2>Regla</h2>
                            </div>

                            <div class="form-wrap">

                                <form class="form-content" id="formFirewall">

                                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

                                    <div class="rule-name">
                                        <div class="form-group">
                                            <label for="inputPort" id="puertoSalida">Nombre de la Regla</label>
                                            <input id="comment" class="form-control" name="comment"
                                                placeholder="Ingrese el nombre de la regla" />
                                        </div>

                                        <div class="form-group">
                                            <label for="regla">Tipo de regla</label>
                                            <select class="form-select" name="regla" id="formSelectRegla">
                                                <option value="" selected disabled>Seleccionar...</option>
                                                <option value="ip">Direcciones IP</option>
                                                <option value="port">Puertos</option>
                                                <option value="ipPort">Direcciones IP y Puertos</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-inputs">

                                        <div class="form1">

                                            <div class="form-group">
                                                <label for="selectEntry">Dirección de la Regla</label>
                                                <select class="form-select" name="entry" id="selectEntry">
                                                    <option value="" selected>Seleccionar...</option>
                                                    <option value="in">Entrada</option>
                                                    <option value="out">Salida</option>
                                                </select>
                                            </div>

                                            <!-- <div class="form-group">
                                            <label for="fromto">Dirección de la Regla</label>
                                            <select class="form-select" name="fromto" id="selectFromTo">
                                                <option value="" selected disabled>Seleccionar...</option>
                                                <option value="from">Origen</option>
                                                <option value="to">Destino</option>
                                            </select>
                                        </div> -->

                                            <div class="form-group">
                                                <label for="ipaddr">Direccion IP</label>
                                                <input type="text" class="form-control" name="ip_addr" id="ipaddr"
                                                    placeholder="0.0.0.0">
                                            </div>

                                            <!-- <div class="form-group">
                                                <label for="selectProtocol">Multiples IPs</label>
                                                <select class="selectpicker" multiple
                                                    aria-label="Default select example" data-live-search="true">
                                                    {% for device in devices %}
                                                    <option value="{{ device['ip'] }}">{{ device['ip'] }} - {{
                                                        device['mac'] }}</option>
                                                    {% endfor %}
                                                </select>
                                            </div> -->

                                            <!-- <div class="form-group">
                                            <label for="netmask">Mascara de Red</label>
                                            <input type="text" class="form-control" name="netmask" id="netmask">
                                        </div> -->

                                            <!-- <div class="form-group">
                                            <label for="ipdest">Direccion IP de Destino</label>
                                            <input type="text" class="form-control" name="ip_dest" id="ipdest"
                                                placeholder="0.0.0.0">
                                        </div> -->

                                            <!-- <div class="form-group">
                                            <label for="ipdest">Mascara de Red Destino</label>
                                            <input type="text" class="form-control" name="dest_netmask" id="maskdest">
                                        </div> -->

                                            <div class="form-group">
                                                <label for="inputPort">Puerto</label>
                                                <input type="text" class="form-control" name="port" id="port">
                                            </div>

                                            <div class="form-group">
                                                <label for="selectProtocol">Protocolo</label>
                                                <select class="form-select" name="protocol" id="selectProtocol">
                                                    <option value="" selected disabled>Seleccionar...</option>
                                                    <option value="tcp">TCP</option>
                                                    <option value="udp">UDP</option>
                                                    <option value="tcp/udp">TCP/UDP</option>
                                                </select>
                                            </div>
                                        </div>

                                        <div class="form2">
                                            <div class="form-group">
                                                <label for="rangePorts" id="puertos">Establecer Rango de Puertos</label>
                                                <select class="form-select" name="rangePorts" id="selectPortRange">
                                                    <option value="" selected disabled>Seleccionar...</option>
                                                    <option value="yes">Si</option>
                                                    <option value="no">No</option>
                                                </select>
                                            </div>

                                            <!-- <div class="form-group">
                                            <label for="inputPort">Puerto</label>
                                            <input type="text" class="form-control" name="port" id="port">
                                            </div> -->

                                            <div class="form-group">
                                                <label for="inputPort" id="puertoEntrada">Puerto Inicial</label>
                                                <input type="text" class="form-control" name="portStart" id="portStart">
                                            </div>

                                            <div class="form-group">
                                                <label for="inputPort" id="puertoSalida">Puerto Final</label>
                                                <input type="text" class="form-control" name="portLimit" id="portEnd">
                                            </div>

                                            <!-- <div class="form-group">
                                            <label for="selectEntry">Entrada o Salida</label>
                                            <select class="form-select" name="entry" id="selectEntry">
                                                <option value="" selected>Seleccionar...</option>
                                                <option value="in">Entrada</option>
                                                <option value="out">Salida</option>
                                            </select>
                                        </div> -->

                                            <!-- <div class="form-group">
                                            <label for="selectProtocol">Protocolo</label>
                                            <select class="form-select" name="protocol" id="selectProtocol">
                                                <option value="" selected disabled>Seleccionar...</option>
                                                <option value="tcp">TCP</option>
                                                <option value="udp">UDP</option>
                                                <option value="">TCP/UDP</option>
                                            </select>
                                        </div> -->
                                        </div>

                                    </div>

                                    <div class="form-group" id="footerBtn">
                                        <button type="button" id="btnCancelar" class="btn btn-secondary"
                                            data-bs-dismiss="modal">Cerrar</button>
                                        <button type="submit" id="btnSave" class="btn btn-primary">Crear
                                            Regla</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <div class="position-fixed top-0 end-0 p-3" style="z-index: 11;">
                            <div id="liveToast" class="toast hide" role="alert" aria-live="assertive"
                                aria-atomic="true">
                                <div class="toast-header">
                                    <img src="../static/img/alert_message.png" class="rounded me-2" alt="...">
                                    <strong class="me-auto">Campo Requerido</strong>
                                    <button type="button" class="btn-close" data-bs-dismiss="toast"
                                        aria-label="Close"></button>
                                </div>
                                <div class="toast-body">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Alerts Message -->
            <div class='alert-message-container'>
                <div class="alert-box" style="float: none; margin: 0 auto;">
                    <div class="alert alert-success">
                        <div class="alert-icon text-center">
                            <i class="fas fa-check-circle fa-3x text-success"></i>
                        </div>
                        <div class="alert-message text-center">
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </section>

    <!-- Multiselect -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    {% include 'includes/js-imports.html' %}
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.14.0-beta2/js/bootstrap-select.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script src="https://unpkg.com/tableexport.jquery.plugin/tableExport.min.js"></script>
    <script src="https://unpkg.com/bootstrap-table@1.15.4/dist/bootstrap-table.min.js"></script>
    <script src="https://unpkg.com/bootstrap-table@1.15.4/dist/bootstrap-table-locale-all.min.js"></script>
    <script
        src="https://unpkg.com/bootstrap-table@1.15.4/dist/extensions/export/bootstrap-table-export.min.js"></script>
    <script src="{{ url_for('static', filename='js/table-rule.js') }}"></script>
    <script src="{{ url_for('static', filename='js/data-input.js') }}"></script>
    <script src="{{ url_for('static', filename='js/edit-rule.js') }}"></script>

    {% endblock %}

</body>

</html>